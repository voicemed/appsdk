{"version":3,"sources":["webpack:///./components/countdown.vue","webpack:///./components/countdown.vue?cd31","webpack:///./components/countdown.vue?6c73"],"names":["EVENT_ABORT","EVENT_PROGRESS","EVENT_START","EVENT_VISIBILITY_CHANGE","name","props","interval","type","Number","default","timerLength","reverse","Boolean","now","Function","Date","emits","EVENT_END","data","counting","totalMilliseconds","requestId","endTime","elapsed","computed","totalSeconds","Math","floor","this","watch","$props","deep","immediate","handler","mounted","document","addEventListener","handleVisibilityChange","beforeUnmount","removeEventListener","pause","methods","restart","start","$emit","visibilityState","continue","getElapsed","_this","delay","min","init","prev","requestAnimationFrame","step","range","progress","end","cancelAnimationFrame","abort","update","max","component","_c","_self","staticClass"],"mappings":"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","file":"ff6f6f0.js","sourcesContent":["\nconst MILLISECONDS_SECOND = 1000;\nconst EVENT_ABORT = 'abort';\nconst EVENT_END = 'end';\nconst EVENT_PROGRESS = 'progress';\nconst EVENT_START = 'start';\nconst EVENT_VISIBILITY_CHANGE = 'visibilitychange';\n\nexport default {\n  name: \"CountDown\",\n  props: {\n    interval: {\n      type: Number,\n      default: 1000\n    },\n    timerLength: {\n      type: Number,\n      default: 10000\n    },\n    reverse: {\n      type: Boolean,\n      default: false\n    },\n    now: {\n      type: Function,\n      default: () => Date.now(),\n    },\n    emits: {\n      EVENT_ABORT,\n      EVENT_END,\n      EVENT_PROGRESS,\n      EVENT_START\n    }\n  },\n  data() {\n    return {\n      counting: false,\n      totalMilliseconds: 0,\n      requestId: 0,\n      endTime: 0,\n      elapsed: 0\n    }\n  },\n  computed: {\n    totalSeconds() {\n      return Math.floor(this.totalMilliseconds / MILLISECONDS_SECOND);\n    }\n  },\n  watch: {\n    $props: {\n      deep: true,\n      immediate: true,\n      handler() {\n        this.totalMilliseconds = this.timerLength;\n        this.endTime = this.now() + this.timerLength;\n        //this.start();\n      }\n    },\n  },\n  mounted() {\n    document.addEventListener(EVENT_VISIBILITY_CHANGE, this.handleVisibilityChange);\n  },\n\n  beforeUnmount() {\n    document.removeEventListener(EVENT_VISIBILITY_CHANGE, this.handleVisibilityChange);\n    this.pause();\n  },\n  methods: {\n    restart() {\n      this.totalMilliseconds = this.timerLength;\n      this.endTime = this.now() + this.timerLength;\n      this.elapsed = 0;\n      this.start();\n    },\n    start() {\n      if (this.counting) {\n        return;\n      }\n      this.counting = true;\n      this.$emit(EVENT_START);\n      if (document.visibilityState === 'visible') {\n        this.continue();\n      }\n    },\n    getElapsed() {\n      return this.elapsed;\n    },\n    continue() {\n      if (!this.counting) {\n        return;\n      }\n      const delay = Math.min(this.totalMilliseconds, this.interval);\n      if (delay > 0) {\n        let init;\n        let prev;\n        const step = (now) => {\n          if (!init) {\n            init = now;\n          }\n          if (!prev) {\n            prev = now;\n          }\n          const range = now - init;\n          if (range >= delay || range + ((now - prev) / 2) >= delay) {\n            this.progress();\n          } else {\n            this.requestId = requestAnimationFrame(step);\n          }\n          prev = now;\n        };\n        this.requestId = requestAnimationFrame(step);\n      } else {\n        this.end();\n      }\n    },\n    pause() {\n      cancelAnimationFrame(this.requestId);\n    },\n    progress() {\n      if (!this.counting) {\n        return;\n      }\n      this.totalMilliseconds -= this.interval;\n      this.elapsed += this.interval;\n      if (this.totalMilliseconds > 0) {\n        this.$emit(EVENT_PROGRESS, {\n          totalSeconds: this.totalSeconds,\n          totalMilliseconds: this.totalMilliseconds,\n          interval: this.interval,\n          elapsed: this.elapsed\n        });\n      }\n      this.continue();\n    },\n    abort() {\n      if (!this.counting) {\n        return;\n      }\n      this.pause();\n      this.counting = false;\n      this.$emit(EVENT_ABORT);\n    },\n    end() {\n      if (!this.counting) {\n        return;\n      }\n      this.pause();\n      this.counting = false;\n      this.$emit(EVENT_END, {\n        totalSeconds: this.totalSeconds,\n        totalMilliseconds: this.totalMilliseconds,\n        interval: this.interval,\n        elapsed: this.elapsed\n      });\n      this.totalMilliseconds = 0;\n    },\n    update() {\n      if (this.counting) {\n        this.totalMilliseconds = Math.max(0, this.endTime - this.now());\n      }\n    },\n    handleVisibilityChange() {\n      switch (document.visibilityState) {\n        case 'visible':\n          this.update();\n          this.continue();\n          break;\n        case 'hidden':\n          this.pause();\n          break;\n        default:\n      }\n    }\n  }\n\n\n}\n","import mod from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./countdown.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./countdown.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./countdown.vue?vue&type=template&id=e4d0548a\"\nimport script from \"./countdown.vue?vue&type=script&lang=js\"\nexport * from \"./countdown.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}