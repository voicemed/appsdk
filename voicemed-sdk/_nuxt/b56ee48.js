(window.webpackJsonp=window.webpackJsonp||[]).push([[19,5,7],{925:function(e,t,n){"use strict";n(5),n(7),n(8),n(6),n(9);var i=n(26),r=(n(0),n(28),n(61),n(62),n(27),n(3),n(37),n(46));function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){Object(i.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.a={name:"basePage",transition:{name:"slide",mode:"out-in",css:!1,beforeEnter:function(e){if(!document.querySelector("#__nuxt").classList.contains("quit")){var t=document.querySelector("#__nuxt").classList.contains("back")?"-100%":"100%";this.$anime.set(e,{scale:1,opacity:0,translateX:t})}},enter:function(e,t){var n=document.querySelector("#__nuxt").classList.contains("back")?"-100%":"100%";this.$anime({targets:e,opacity:[0,1],translateX:[n,"0"],duration:500,easing:"easeInOutSine",complete:t})},leave:function(e,t){if(document.querySelector("#__nuxt").classList.contains("quit"))this.$anime({targets:e,translateY:[0,"100%"],duration:500,easing:"easeInOutSine",complete:t});else{var n=document.querySelector("#__nuxt").classList.contains("back")?"100%":"-100%";this.$anime({targets:e,opacity:[1,0],translateX:["0",n],duration:500,easing:"easeInOutSine",complete:t})}},afterLeave:function(e){document.querySelector("#__nuxt").classList.remove("quit"),document.querySelector("#__nuxt").classList.remove("back")}},data:function(){return{name:"basePage",exid:this.$route.params.id,programid:this.$route.params.fromprogram||!1,withindex:this.$route.params.withindex||-1,backto:this.$route.params.backto||!1,hasBack:!1,hasNext:!1,hasInfo:!1}},computed:s(s({},Object(r.d)({getCurrentPagerHeight:"getCurrentPagerHeight"})),{},{isVoicemed:function(){return $nuxt.$config.env.environment.indexOf("voicemed_")>-1},isAirlyn:function(){return $nuxt.$config.env.environment.indexOf("voicemed_")<0},nuxtloading:function(){return $nuxt.$loading.loading},defaultHomeUrl:function(){return"/"}}),methods:s(s({},Object(r.c)({setCurrentPage:"setCurrentPage",setCurrentPagerHeight:"setCurrentPagerHeight"})),{},{exerciseStepBack:function(){if(console.log("exit test",this.backto,this.programid),"standalone"==this.backto)return $nuxt.$airlyn.finishExercise({reason:"user-cancelled",result:{}}).finally((function(){console.log("exercise finished by user")})),void $nuxt.$airlyn.closeExercise().finally((function(){console.log("exercise closed, success")}));"today"!=this.backto?"discovery"!=this.backto?this.programid?"-1"==this.programid||-1==this.programid||"false"==this.programid||0==this.programid?$nuxt.$router.replace($nuxt.localePath("/user/today")):$nuxt.$router.replace($nuxt.localePath("/ml/programs/"+this.programid)):$nuxt.$router.replace($nuxt.localePath("/user/today")):$nuxt.$router.replace($nuxt.localePath("/home")):$nuxt.$router.replace($nuxt.localePath("/user/today"))},buildSuffix:function(){var e=[],t=!!this.programid&&this.programid;return e.push("-1"!==t&&t),e.push(this.withindex?this.withindex:"-1"),e.push(!!this.backto&&this.backto),e.join("/")},hasJoinedProgramById:function(e){return this.$nuxt.$store.getters.hasJoinedProgramById(e)},getProgramJoinedAtById:function(e){return this.$nuxt.$store.getters.getProgramJoinedAtById(e)},getProgramById:function(e){return this.$nuxt.$store.getters.getProgramById(e)},getOverallProgressProgramById:function(e){return this.$nuxt.$store.getters.getOverallProgressProgramById(e)},getDoneCountByProgramId:function(e){return this.$nuxt.$store.getters.getDoneCountByProgramId(e)},getNextExerciseByProgramId:function(e){return this.$nuxt.$store.getters.getNextExerciseByProgramId(e)},getExercisetocompleteCountProgramById:function(e){return this.$nuxt.$store.getters.getExercisetocompleteCountProgramById(e)},getExercisecompletedCountProgramById:function(e){return this.$nuxt.$store.getters.getExercisecompletedCountProgramById(e)},printDeviceError:function(e,t,n,i){this.$analytics.logEvent("permission_error",{title:"errors."+e+"."+t.name.toLowerCase()+".title",kind:e}),console.error("Got device error",t),!t||"NotAllowedError"!==t.name&&"NotFoundError"!==t.name&&"denied"!=t.exception.state&&"DENIED"!=t.exception.state?this.showError(this.$t("errors.generic.title"),this.$t("errors.generic.description"),n,i):this.$root.$emit("showPermssionError",!0)},printDeviceErrorOLD:function(e,t,n,i){if(this.$analytics.logEvent("permission_error",{title:"errors."+e+"."+t.name.toLowerCase()+".title",kind:e}),console.error("Got device error",t),t.exception&&"mic"==e&&("denied"==t.exception.state||"DENIED"==t.exception.state))return t.name="DeniedError",void this.$root.$emit("showError",{title:this.$t("errors."+e+"."+t.name.toLowerCase()+".title"),error:this.$t("errors."+e+"."+t.name.toLowerCase()+".description"),hasretry:!0,click:function(){return $nuxt.$airlyn.openPermissionPanel().then((function(e){console.log("got openPermission Panel then",e,JSON.stringify(e))})).catch((function(e){console.log("got openPermission Panel catch",e,JSON.stringify(e))})).finally((function(){"function"==typeof i&&(console.log("dopo il setting riport cmq a inizio"),i())})),!0},resetEvent:i||function(){},retryBtn:"Settings"});!t||"NotAllowedError"!==t.name&&"NotFoundError"!==t.name?this.showError(this.$t("errors.generic.title"),this.$t("errors.generic.description"),n,i):this.showError(this.$t("errors."+e+"."+t.name.toLowerCase()+".title"),this.$t("errors."+e+"."+t.name.toLowerCase()+".description"),n,i)},manageMicError:function(e,t,n){this.printDeviceError("mic",e,t,n)},manageCamError:function(e,t,n){this.printDeviceError("cam",e,t,n)},manageMicCamError:function(e,t,n){this.printDeviceError("miccam",e,t,n)},showError:function(e,t,n,i){this.$root.$emit("showError",{title:e,error:t,hasretry:null!==n,click:n||function(){},resetEvent:i||function(){}})},swipeEvent:function(e){this.$root.$emit("swipe",e)},attachSwipeListener:function(){document.addEventListener("swiped-left",this.swipeEvent),document.addEventListener("swiped-right",this.swipeEvent)},detachSwipeListeners:function(){document.removeEventListener("swiped-left",this.swipeEvent),document.removeEventListener("swiped-right",this.swipeEvent)},fixWindowVariables:function(e){void 0===window[e]&&"undefined"!==window.top[e]&&(window[e]=window.top[e])}}),beforeMount:function(){var e=this;console.log("PRE loaded base Page"),console.log("fix loading variables"),["currentExercise","currentVMToken","currentVMKey","currentVMUrl"].forEach((function(t){e.fixWindowVariables(t)})),this.setCurrentPage(this)},beforeDestroy:function(){this.detachSwipeListeners()},mounted:function(){var e=this;console.log("loaded base Page"),console.log("try Load index",this.name,this.dynamicTexts),this.dynamicTexts&&Object.keys(this.dynamicTexts).length>0&&Object.keys(this.dynamicTexts).map((function(t){e.$appConfiguration.getText(t).then((function(n){e.dynamicTexts[t]=n})).catch((function(n){e.dynamicTexts[t]=e.$t(e.name+"."+t)}))})),null!==this.getCurrentPagerHeight&&document.querySelector(".v-main__wrap > div.pager")&&(document.querySelector(".v-main__wrap > div.pager").style.height=this.getCurrentPagerHeight+"px"),this.$nextTick((function(){e.attachSwipeListener(),null===e.getCurrentPagerHeight&&document.querySelector(".v-main__wrap > div.pager")&&e.setCurrentPagerHeight(Math.max(document.querySelector(".v-main__wrap > div.pager").clientHeight,document.querySelector(".v-main__wrap > div.pager").offsetHeight))}))}}},928:function(e,t,n){"use strict";n.r(t);n(315);var i="abort",r="progress",o="start",s="visibilitychange",a={name:"CountDown",props:{interval:{type:Number,default:1e3},timerLength:{type:Number,default:1e4},reverse:{type:Boolean,default:!1},now:{type:Function,default:function(){return Date.now()}},emits:{EVENT_ABORT:i,EVENT_END:"end",EVENT_PROGRESS:r,EVENT_START:o}},data:function(){return{counting:!1,totalMilliseconds:0,requestId:0,endTime:0,elapsed:0}},computed:{totalSeconds:function(){return Math.floor(this.totalMilliseconds/1e3)}},watch:{$props:{deep:!0,immediate:!0,handler:function(){this.totalMilliseconds=this.timerLength,this.endTime=this.now()+this.timerLength}}},mounted:function(){document.addEventListener(s,this.handleVisibilityChange)},beforeUnmount:function(){document.removeEventListener(s,this.handleVisibilityChange),this.pause()},methods:{restart:function(){this.totalMilliseconds=this.timerLength,this.endTime=this.now()+this.timerLength,this.elapsed=0,this.start()},start:function(){this.counting||(this.counting=!0,this.$emit(o),"visible"===document.visibilityState&&this.continue())},getElapsed:function(){return this.elapsed},continue:function(){var e=this;if(this.counting){var t=Math.min(this.totalMilliseconds,this.interval);if(t>0){var n,i;this.requestId=requestAnimationFrame((function r(o){n||(n=o),i||(i=o);var s=o-n;s>=t||s+(o-i)/2>=t?e.progress():e.requestId=requestAnimationFrame(r),i=o}))}else this.end()}},pause:function(){cancelAnimationFrame(this.requestId)},progress:function(){this.counting&&(this.totalMilliseconds-=this.interval,this.elapsed+=this.interval,this.totalMilliseconds>0&&this.$emit(r,{totalSeconds:this.totalSeconds,totalMilliseconds:this.totalMilliseconds,interval:this.interval,elapsed:this.elapsed}),this.continue())},abort:function(){this.counting&&(this.pause(),this.counting=!1,this.$emit(i))},end:function(){this.counting&&(this.pause(),this.counting=!1,this.$emit("end",{totalSeconds:this.totalSeconds,totalMilliseconds:this.totalMilliseconds,interval:this.interval,elapsed:this.elapsed}),this.totalMilliseconds=0)},update:function(){this.counting&&(this.totalMilliseconds=Math.max(0,this.endTime-this.now()))},handleVisibilityChange:function(){switch(document.visibilityState){case"visible":this.update(),this.continue();break;case"hidden":this.pause()}}}},c=n(42),u=Object(c.a)(a,(function(){return(0,this._self._c)("div",{staticClass:"countdown_wrapper"})}),[],!1,null,null,null);t.default=u.exports},929:function(e,t,n){"use strict";n.r(t);n(315);var i={props:{value:{type:Number,default:0},exerciseSteps:{type:Number,default:1},startPercent:{type:Number,default:0},doneClass:{type:String,default:"done"},maxPercent:{type:Number,default:1},runningPercent:{type:Number,default:0}},computed:{primaryColor:function(){return $nuxt.$config.env.environment.indexOf("voicemed_")>-1?"#EC483F":"#848CE6"},exercisescount:function(){return this.exerciseSteps},currentExercise:function(){return this.value},currentPercent:function(){return this.runningPercent}},methods:{getRotation:function(e){return 0===e?"transform:rotate(0deg);":"transform:rotate("+360/this.exercisescount*e+"deg);"}}},r=n(42),o=Object(r.a)(i,(function(){var e=this,t=e._self._c;return t("div",{class:["donut_progress"]},[t("vc-donut",{attrs:{background:"#FFFFFF",foreground:"#848CE633",size:100,unit:"%",thickness:5,sections:[{label:"progress",value:e.currentPercent,color:e.primaryColor}],total:100,"start-angle":0,"auto-adjust-text-size":!0}},[e._t("inside")],2)],1)}),[],!1,null,null,null);t.default=o.exports},965:function(t,n,i){"use strict";i.r(n);i(3),i(5),i(7),i(8),i(6),i(9);var r=i(26),o=(i(27),i(28),i(61),i(0),i(37),i(112),i(62),i(925)),s=i(928),a=i(46);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l={name:"ml_start",mixins:[o.a],components:{CountDownItem:s.default},beforeRouteLeave:function(e,t,n){document.querySelector(".nextvm").classList.remove("pumpAnimation"),this.$closeStream(),n()},data:function(){return{audioLevels:{peakLevel:0,averageLevel:0},audioInput:{},exid:this.$route.params.id,programid:this.$route.params.fromprogram||!1,withindex:this.$route.params.withindex||!1,backto:this.$route.params.backto||!1,name:"ml_start",deviceInfo:"",hasBack:!0,hasNext:!0,timer:0,countdownrunning:!1,startTimer:!1,audio:{audioContext:null,audioInput:null,realAudioInput:null,inputPoint:null,audioRecorder:null,stereo:!1},bottomsheet:{show:!1},uploadProgress:0,passed:!1,hasWarning:!1,errorMessage:"",loading:!1,finish:!1,intervals:[]}},computed:u(u({},Object(a.d)({getExercises:"getExercises",getCurrentExercise:"getCurrentExercise",getAudioDevices:"getAudioDevices"})),{},{exercise:function(){return this.getCurrentExercise},currentUploadProgress:function(){var e=100*this.uploadProgress;return e>100?100:e},currentPercent:function(){var e=this.timer/this.timerLength*100*75/100+25*this.currentUploadProgress/100;return e>100?100:e},timerLength:function(){return 5},timerRest:function(){return 5-this.timer},getTitle:function(){return this.$t(this.name+".title").replace("%s",this.timer)}}),methods:{exitStep:function(){document.querySelector("#__nuxt")&&document.querySelector("#__nuxt").classList.add("quit"),this.exerciseStepBack()},retryNoise:function(){return this.bottomsheet.show=!1,this.setupAll(),!0},leaveMe:function(){var e=this;this.$refs.noisecountdown.abort(),this.$capacitor.isNativePlatform()?(this.$nuxt.$loading.start(),$nuxt.$airlyn.removeAllListeners(),this.$airlyn.stopRecording().finally((function(){e.$nuxt.$loading.finish(),document.querySelector("#__nuxt")&&document.querySelector("#__nuxt").classList.add("quit"),e.$router.push($nuxt.localePath("/ml/exercises/"+e.exid))}))):(this.$closeStream(),this.audio&&this.audio.audioRecorder&&this.audio.audioRecorder.stop(),document.querySelector("#__nuxt")&&document.querySelector("#__nuxt").classList.add("quit"),this.$router.push($nuxt.localePath("/ml/exercises/"+this.exid)))},prevStep:function(){var e=this;this.intervals.map((function(e){try{clearTimeout(e)}catch(e){}})),this.$refs.noisecountdown.abort(),this.$capacitor.isNativePlatform()?(this.$nuxt.$loading.start(),this.$airlyn.stopRecording().finally((function(){e.$nuxt.$loading.finish(),e.$router.back()}))):(this.$closeStream(),this.audio&&this.audio.audioRecorder&&this.audio.audioRecorder.stop(),this.$router.back())},nextStep:function(){var e=this.buildSuffix();e.length>0&&(e="/"+e),this.exercise.type===this.$exerciseManager.kindHOLD?this.$router.push($nuxt.localePath("/ml/exercises/"+this.exid+"/runnersilent"+e)):this.$router.push($nuxt.localePath("/ml/exercises/"+this.exid+"/runner"+e))},sendDataToRest:function(e){var t=this;this.passed=!1,this.loading=!0,this.$nuxt.$loading.start();var n=new Date,i=this.$auth.user?this.$auth.user._id||this.$auth.user.userId:n.getMilliseconds(),r=new File([e],"soundcheck_"+i+".wav",{type:"audio/x-wav",lastModified:Date.now()}),o=new FormData;o.append("audio",r,r.name),o.append("device_code",this.deviceInfo),this.audioInput&&o.append("device_info",JSON.stringify(this.audioInput));var s={Authorization:"Bearer "+window.currentVMToken,timeout:this.$exerciseManager.longTaskTimeout,onUploadProgress:function(e){t.uploadProgress=e.loaded/e.total}};this.$axios.$post($nuxt.$apiConstants.preNoiseCheck_v2,o,s).then((function(e){console.log("noiseCheck result",e),t.uploadProgress=1,t.passed=!1,t.hasWarning=!1,t.errorMessage="";var n="",i="";e&&e.resultCode?e.resultCode>310?t.passed=!0:e.resultCode>307?(t.passed=!0,t.hasWarning=!0,t.errorMessage=e.message||t.$t("errors.noise.description")):(t.passed=!1,n=t.$t("errors.noise.title"),t.errorMessage=e.message||t.$t("errors.noise.description")):(t.passed=!1,n=t.$t("errors.noise.title"),i=t.$t("errors.noise.description")),!1===t.passed&&t.$root.$emit("showError",{hasretry:!0,title:n,error:i,leaveBtn:t.$t("generic.startanyway"),click:function(){return t.setupAll(),t.$gtag("event","click",{event_label:"NoiseReCheck",event_category:"Exercises"}),!0},resetEvent:function(){return t.passed=!0,t.$gtag("event","click",{event_label:"NoiseStartAnyWay",event_category:"Exercises"}),t.bottomsheet.show=!0,!0}})})).catch((function(e){console.log("noiseCheck error",e),console.error("Errore invio api [pre_noise_check]:",e),t.$analytics.logEvent("error",{title:"noise check error"}),t.$captureException(e),t.$root.$emit("showError",{hasretry:!1,title:"An error has occurred",error:"Sorry an issue with the VoiceServer has occurred",click:function(){return t.setupAll(),t.$gtag("event","click",{event_label:"NoiseReCheck",event_category:"Exercises"}),!0},resetEvent:function(){return t.passed=!0,t.$gtag("event","click",{event_label:"NoiseStartAnyWay",event_category:"Exercises"}),t.bottomsheet.show=!0,!0}})})).finally((function(){t.passed&&(t.$root.$emit("disableNext",!1),t.$nextTick((function(){document.querySelector(".nextvm").classList.add("pumpAnimation")}))),t.loading=!1,t.finish=!0,t.$nuxt.$loading.finish()}))},gotData:function(e){var t=this;console.log("got buffers"),this.$nuxt.$loading.finish(),this.audio.audioRecorder.exportMonoWAV((function(e){t.$closeStream(),t.sendDataToRest(e)}))},gotDataNative:function(e,t){console.log("ready to store file for sending...",t);var n=this.$base64ToBlob(e,t);this.sendDataToRest(n)},stopRecording:function(){var t=this;this.$nuxt.$loading.start(),this.loading=!0,this.$capacitor.isNativePlatform()?(console.log("request stop recording!"),this.$airlyn.removeAllListeners(),this.$airlyn.stopRecording().then((function(n){n&&n.value?t.gotDataNative(n.value.recordDataBase64,n.value.mimeType):(console.error("(catch)Errore stop :",e),t.manageMicError({name:"Cannot retrieve Recording",error:e},null,(function(){return this.exitStep(),!0})))})).catch((function(e){console.error("(catch)Errore stop :",e),t.manageMicError({name:"Cannot retrieve Recording",error:e},null,(function(){return this.exitStep(),!0}))})).finally((function(){t.$nuxt.$loading.finish()}))):(console.log("request stop web"),this.audio.audioRecorder.stop(),console.log("retrieve buffers"),this.audio.audioRecorder.getBuffers(this.gotData))},timerChange:function(e){this.timer=this.timerLength-e.totalSeconds},timerEnd:function(){console.log("timer finito, ",this.timer),this.countdownrunning=!1,this.loading=!0,this.stopRecording()},countDownTimer:function(){var e=this;!1!==this.countdownrunning||this.intervals.push(setTimeout((function(){e.$nextTick((function(){console.log("avvia tutto"),e.countdownrunning=!0,console.log(e.$refs),e.$refs.noisecountdown.restart()}))}),1e3))},initCountDown:function(){this.timer=0,this.uploadProgress=0,this.countdownrunning=!1,this.startTimer=!0,this.audio.audioRecorder.clear(),this.audio.audioRecorder.record(),this.countDownTimer()},initCountDownNative:function(){var e=this;this.timer=0,this.uploadProgress=0,this.countdownrunning=!1,this.startTimer=!0,$nuxt.$airlyn.addListener("airlynUpdateMeters",(function(t){t&&(t.peakPower&&(e.audioLevels.peakLevel=t.peakPower),t.averagePower&&(e.audioLevels.averageLevel=t.averagePower))})),$nuxt.$airlyn.addListener("airlynUpdateMic",(function(t){console.log("got mic INFO",t),e.audioInput=t})),this.$airlyn.startRecording({useAGC:!0}).then((function(t){console.log("start recording...",t),t&&!0===t.value?e.countDownTimer():(console.error("(then)Errore start :",t),e.manageMicError({name:"Cannot start Recording"},null,(function(){return this.exitStep(),!0})))})).catch((function(t){console.error("(catch)Errore start :",t),e.manageMicError({name:"Cannot start Recording",error:t},null,(function(){return this.exitStep(),!0}))}))},initMicrophone:function(e){this.audio.inputPoint=this.audio.audioContext.createGain(),this.audio.realAudioInput=this.audio.audioContext.createMediaStreamSource(e),this.audio.audioInput=this.audio.realAudioInput,this.audio.audioInput.connect(this.audio.inputPoint),this.audio.realAudioInput.disconnect(),this.audio.audioInput=this.convertToMono(this.audio.realAudioInput),this.audio.audioInput.connect(this.audio.inputPoint),this.audio.audioRecorder=new this.$Recorder(this.audio.inputPoint,{worker:this.$worker.createRecorderWorker()}),this.initCountDown()},convertToMono:function(e){var t=this.audio.audioContext.createChannelSplitter(2),n=this.audio.audioContext.createChannelMerger(2);return e.connect(t),t.connect(n,0,0),t.connect(n,0,1),n},setupAll:function(){var e=this;if(this.loading=!1,this.finish=!1,this.$closeStream(),this.$capacitor.isNativePlatform())this.timer=0,this.countdownrunning=!1,this.initCountDownNative();else{var t=[];console.log(JSON.stringify(this.getAudioDevices)),console.log(navigator.mediaDevices.getSupportedConstraints()),t.push("Ready to record Audio"),t.push(JSON.stringify(this.getAudioDevices)),t.push("Supported Constraints:"),t.push(JSON.stringify(navigator.mediaDevices.getSupportedConstraints())),null==this.audio.audioContext&&(this.audio.audioContext=new AudioContext),this.$captureMessage(t.join("\n ")),this.$enumerateMediaDevices().then((function(t){return console.log("got devices",t),e.$initAudio(t).then((function(t){console.log(t),window.stream=t,null==e.audio.audioContext&&(e.audio.audioContext=new AudioContext),e.timer=0,e.countdownrunning=!1,e.initMicrophone(t)}))})).catch((function(t){console.error("errore init microfono non gestito",t),e.$captureException(t),e.manageMicError(t,null,(function(){return this.exitStep(),!0}))}))}}},mounted:function(){var e=this;this.$root.$emit("showPager",{show:!0}),this.$deviceInfo.getInfo().then((function(t){e.deviceInfo=t,e.$exerciseManager.setDeviceCode(t)})),this.$capacitor.isNativePlatform()&&(this.$closeStream(),this.$airlyn.checkMicPerm().then((function(t){if(console.log("Permessi al microfono garantiti?",t,JSON.stringify(t)),t&&!0===t.result)console.log("permessi OK!");else{var n={name:"NotAllowedError",exception:t};e.manageMicError(n,null,(function(){return this.exitStep(),!0}))}})).catch((function(t){console.error("Permission request fails",t),e.manageMicError({name:"NotAllowedError",exception:t},null,(function(){return this.exitStep(),!0}))}))),this.$nextTick((function(){e.$root.$emit("showPager",{show:!0}),e.$root.$emit("setNextText",e.$t("generic.start_chevron")),e.$root.$emit("disableNext",!0)})),this.intervals.push(setTimeout((function(){e.$nextTick((function(){e.setupAll()}))}),700))}},d=i(42),h=Object(d.a)(l,(function(){var e=this,t=e._self._c;return t("fullpage-card",{staticClass:"center-title noise exercisecc",attrs:{hidefooter:!0},scopedSlots:e._u([{key:"header",fn:function(){return[t("v-row",{staticClass:"navigation",attrs:{"align-content":"center",justify:"center"}},[t("div",{staticClass:"exercise__title"},[t("span",[e._v(e._s(e.$t("generic.soundcheck")))])])])]},proxy:!0},{key:"body",fn:function(){return[t("div",{directives:[{name:"show",rawName:"v-show",value:e.getCurrentExercise,expression:"getCurrentExercise"}],key:e.countdownrunning,staticClass:"exercises__container noisechecker"},[t("exerciseanimationprogress",{key:e.countdownrunning,staticClass:"finished",attrs:{exerciseSteps:0,startPercent:0,maxPercent:0,doneClass:"doneNone",runningPercent:e.currentPercent},scopedSlots:e._u([{key:"inside",fn:function(){return[t("div",{staticClass:"timer text-center noise"},[t("transition",{attrs:{mode:"out-in",name:"exittop"}},[e.timer<e.timerLength&&e.countdownrunning?t("p",{key:e.finish&&e.loading&&e.countdownrunning,domProps:{innerHTML:e._s(e.$t("generic.noisestart"))}}):e._e(),e._v(" "),!e.finish&&e.loading?t("p",{key:!e.finish&&e.loading,domProps:{innerHTML:e._s(e.$t("ml_exercise.almostdone"))}}):e._e(),e._v(" "),e.finish&&!e.loading?t("p",{key:e.finish&&!e.loading,domProps:{innerHTML:e._s(e.$t("generic.noiseready"))}}):e._e()])],1)]},proxy:!0}]),model:{value:e.timer,callback:function(t){e.timer=t},expression:"timer"}}),e._v(" "),t("div",{staticStyle:{display:"none"}},[t("b",[e._v("Debug")]),t("br"),e._v(" "),t("p",[e._v("Peak dB:"),t("b",[e._v(e._s(e.audioLevels.peakLevel))])]),t("br"),e._v(" "),t("p",[e._v("Average dB:"),t("b",[e._v(e._s(e.audioLevels.averageLevel))])])])],1),e._v(" "),t("CountDownItem",{ref:"noisecountdown",attrs:{timerLength:1e3*e.timerLength,interval:500},on:{progress:e.timerChange,end:e.timerEnd}}),e._v(" "),t("v-bottom-sheet",{attrs:{persistent:"","overlay-opacity":.9},model:{value:e.bottomsheet.show||e.hasWarning,callback:function(t){e.$set(e.bottomsheet,"show||hasWarning",t)},expression:"bottomsheet.show||hasWarning"}},[t("div",{staticClass:"bottomsheet"},[t("div",{staticClass:"text"},[e._v("\n          "+e._s(e.errorMessage||e.$t("generic.noisewarning"))+"\n        ")]),e._v(" "),t("div",{staticClass:"actions"},[t("v-btn",{attrs:{color:"leavevm",text:"",nuxt:"",outlined:""},on:{click:e.nextStep}},[t("div",{staticClass:"btncustomcontent",domProps:{innerHTML:e._s(e.$t("generic.startanyway"))}})]),e._v(" "),t("v-spacer"),e._v(" "),t("v-btn",{attrs:{color:"nextvm",nuxt:""},on:{click:e.retryNoise}},[t("span",{domProps:{innerHTML:e._s(e.$t("generic.retry"))}}),e._v(" "),t("v-icon",[e._v("mdi-reload")])],1)],1)])])]},proxy:!0},{key:"footer",fn:function(){return[t("a",{staticStyle:{display:"none"},attrs:{href:"#",id:"downloader"}},[e._v("Download audio")]),e._v(" "),t("div",{class:["leaveFab",e.countdownrunning?"":"disabled"]},[t("v-btn",{staticClass:"leavebtn",attrs:{icon:"",disabled:!e.countdownrunning},on:{click:e.leaveMe}},[t("v-icon",{attrs:{"x-small":""}},[e._v("mdi-window-close")])],1)],1)]},proxy:!0}])})}),[],!1,null,null,null);n.default=h.exports;installComponents(h,{Exerciseanimationprogress:i(929).default,FullpageCard:i(220).default})}}]);
//# sourceMappingURL=b56ee48.js.map