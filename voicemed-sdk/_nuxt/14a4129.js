(window.webpackJsonp=window.webpackJsonp||[]).push([[23,5,7,10],{923:function(e,t,i){"use strict";i(5),i(7),i(8),i(9);var r=i(179),n=i(24),s=i(26),o=(i(98),i(0),i(28),i(62),i(63),i(27),i(37),i(221),i(10),i(6),i(220),i(112),i(3),i(46));function a(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function c(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?a(Object(i),!0).forEach((function(t){Object(s.a)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}t.a={name:"basePage",transition:{name:"slide",mode:"out-in",css:!1,beforeEnter:function(e){if(!document.querySelector("#__nuxt").classList.contains("quit")){var t=document.querySelector("#__nuxt").classList.contains("back")?"-100%":"100%";this.$anime.set(e,{scale:1,opacity:0,translateX:t})}},enter:function(e,t){var i=document.querySelector("#__nuxt").classList.contains("back")?"-100%":"100%";this.$anime({targets:e,opacity:[0,1],translateX:[i,"0"],duration:500,easing:"easeInOutSine",complete:t})},leave:function(e,t){if(document.querySelector("#__nuxt").classList.contains("quit"))this.$anime({targets:e,translateY:[0,"100%"],duration:500,easing:"easeInOutSine",complete:t});else{var i=document.querySelector("#__nuxt").classList.contains("back")?"100%":"-100%";this.$anime({targets:e,opacity:[1,0],translateX:["0",i],duration:500,easing:"easeInOutSine",complete:t})}},afterLeave:function(e){document.querySelector("#__nuxt").classList.remove("quit"),document.querySelector("#__nuxt").classList.remove("back")}},data:function(){return{name:"basePage",exid:this.$route.params.id,programid:this.$route.params.fromprogram||!1,withindex:this.$route.params.withindex||-1,backto:this.$route.params.backto||!1,hasBack:!1,hasNext:!1,hasInfo:!1,currentTutorial:!1,tutorialList:[],tutorialShownHard:!1}},computed:c(c({},Object(o.d)({getCurrentPagerHeight:"getCurrentPagerHeight",getTutorialShown:"getTutorialShown",getLocalTutorialShown:"getLocalTutorialShown"})),{},{isVoicemed:function(){return $nuxt.$config.env.environment.indexOf("voicemed_")>-1},isAirlyn:function(){return $nuxt.$config.env.environment.indexOf("voicemed_")<0},nuxtloading:function(){return $nuxt.$loading.loading},defaultHomeUrl:function(){return"/user/today"}}),methods:c(c({},Object(o.c)({setCurrentPage:"setCurrentPage",setCurrentPagerHeight:"setCurrentPagerHeight",setTutorialRunPerPage:"setTutorialRunPerPage",setTutorialRun:"setTutorialRun"})),{},{setTutorialRunLocal:function(){this.setPreferenceTutorial()},tutorialClose:function(){this.$set(this,"tutorialList",[]),this.setTutorialRunLocal(),this.currentTutorial=null},tutorialHasNext:function(){var e=this.currentTutorial.index;return!!this.tutorialList.find((function(t){return t.index===e+1}))},exerciseStepBack:function(){console.log("exit test",this.backto,this.programid),"today"!=this.backto?"discovery"!=this.backto?this.programid?"-1"==this.programid||-1==this.programid||"false"==this.programid||0==this.programid?$nuxt.$router.replace($nuxt.localePath("/user/today")):$nuxt.$router.replace($nuxt.localePath("/ml/programs/"+this.programid)):$nuxt.$router.replace($nuxt.localePath("/user/today")):$nuxt.$router.replace($nuxt.localePath("/home")):$nuxt.$router.replace($nuxt.localePath("/user/today"))},buildSuffix:function(){var e=[],t=!!this.programid&&this.programid;return e.push("-1"!==t&&t),e.push(this.withindex?this.withindex:"-1"),e.push(!!this.backto&&this.backto),e.join("/")},tutorialNext:function(){var e=this.currentTutorial?this.currentTutorial.index:0;this.currentTutorial?(this.currentTutorial.visible=!1,this.setTutorialRunLocal()):e=this.tutorialList[0].index-1;var t=this.tutorialList.find((function(t){return t.index===e+1}));if(t){this.currentTutorial=t;t.position.height;var i=t.position.top>this.appHeight/2?t.position.top-210:t.position.top-10;t.arrowTop&&(i=t.position.top-(t.position.height+10)),i=Math.max(0,i),console.warn("Nuovo scroll Top:",i,this.appHeight,this.footerHeight,t.position.height),this.$nextTick((function(){document.querySelector(".indexPage").scrollTo({top:i,left:0,behavior:"smooth"})})),t.visible=!0}else this.tutorialClose()},getTutorialIndex:function(){return this.currentTutorial?this.currentTutorial.index>this.tutorialList.length?this.tutorialList.length:this.currentTutorial.index:""},getTutorialText:function(e){return this.$t("tutorials."+this.name+".text_"+e.index,{title:e.title})},getTutorialDialogStyle:function(e){var t={},i=e.position,r=i.top;return this.$capacitor&&this.$capacitor.isNativePlatform()&&0==e.updated&&(r=i.top,e.updated=!0,console.warn("apply tutorial offset for mobile phones")),t.top=r>300?r-200+"px":r+i.height+10+"px",console.warn("DialogStyle for tutorial",e,t),"fill"!==e.width?t.left="calc("+i.left+"px - 75vw + "+i.width+"px )":(t.left="0px",t.right="0px"),Object.entries(t).map((function(e){var t=Object(n.a)(e,2),i=t[0],r=t[1];return"".concat(i,":").concat(r)})).join(";")},getTutorialStyle:function(e){var t={},i=e.position,r=i.top;return this.$capacitor&&this.$capacitor.isNativePlatform()&&0==e.updated&&(r=i.top,e.updated=!0),console.warn("Style for tutorial",e,r),"fill"===e.width?(t.top=r-4+"px",t.left="0px",t.right="0px",t.height=i.height+8+"px"):(t.top=r-4+"px",t.left=i.left-4+"px",t.right="0px",t.height=i.height+8+"px",t.width=i.width+8+"px"),Object.entries(t).map((function(e){var t=Object(n.a)(e,2),i=t[0],r=t[1];return"".concat(i,":").concat(r)})).join(";")},initTutorial:function(){var e=this,t=Object(r.a)(document.querySelectorAll(".hastutorial")),i=!1;if(this.$capacitor&&this.$capacitor.isNativePlatform()?i=this.tutorialShownHard:(this.tutorialShownHard=this.$nuxt.$store.getters.getTutorialRun(this.name),i=this.$nuxt.$store.getters.getTutorialRunPerPage(this.name)),void 0!==this.getTutorialShown[this.name]||i||this.tutorialShownHard)console.warn("hide tutorial, not needed at this round");else{if(this.$set(this,"tutorialList",[]),t.length>0){document.querySelector(".indexPage").scrollTo({top:0,left:0,behavior:"smooth"});var n=this.getLocalTutorialShown;console.warn("got local tutorials",n),t.forEach((function(t){var i=parseInt(t.dataset.tutorialindex);if(void 0===n[e.name+"_"+i]){var r=t.getBoundingClientRect();e.tutorialList.push({position:r,visible:!1,itemRef:t,updated:!1,arrowTop:"top"==t.dataset.tutorialarrow,title:t.dataset.tutorial,width:t.dataset.tutorialwidth,index:i})}})),window.tutorialList=this.tutorialList}this.tutorialList.length>0&&(this.tutorialList=this.tutorialList.sort((function(e,t){return e.index>t.index?1:t.index>e.index?-1:0}))),this.tutorialList.length>0&&(this.currentTutorial=0,this.$nextTick((function(){setTimeout((function(){e.tutorialList.forEach((function(e){e.position=e.itemRef.getBoundingClientRect()})),e.tutorialNext(),e.setTutorialRunPerPage(e.name)}),200)})))}},hasJoinedProgramById:function(e){return this.$nuxt.$store.getters.hasJoinedProgramById(e)},getProgramJoinedAtById:function(e){return this.$nuxt.$store.getters.getProgramJoinedAtById(e)},getProgramById:function(e){return this.$nuxt.$store.getters.getProgramById(e)},getOverallProgressProgramById:function(e){return this.$nuxt.$store.getters.getOverallProgressProgramById(e)},getDoneCountByProgramId:function(e){return this.$nuxt.$store.getters.getDoneCountByProgramId(e)},getNextExerciseByProgramId:function(e){return this.$nuxt.$store.getters.getNextExerciseByProgramId(e)},getExercisetocompleteCountProgramById:function(e){return this.$nuxt.$store.getters.getExercisetocompleteCountProgramById(e)},getExercisecompletedCountProgramById:function(e){return this.$nuxt.$store.getters.getExercisecompletedCountProgramById(e)},printDeviceError:function(e,t,i,r){this.$analytics.logEvent("permission_error",{title:"errors."+e+"."+t.name.toLowerCase()+".title",kind:e}),console.error("Got device error",t),!t||"NotAllowedError"!==t.name&&"NotFoundError"!==t.name&&"denied"!=t.exception.state&&"DENIED"!=t.exception.state?this.showError(this.$t("errors.generic.title"),this.$t("errors.generic.description"),i,r):this.$root.$emit("showPermssionError",!0)},printDeviceErrorOLD:function(e,t,i,r){if(this.$analytics.logEvent("permission_error",{title:"errors."+e+"."+t.name.toLowerCase()+".title",kind:e}),console.error("Got device error",t),t.exception&&"mic"==e&&("denied"==t.exception.state||"DENIED"==t.exception.state))return t.name="DeniedError",void this.$root.$emit("showError",{title:this.$t("errors."+e+"."+t.name.toLowerCase()+".title"),error:this.$t("errors."+e+"."+t.name.toLowerCase()+".description"),hasretry:!0,click:function(){return $nuxt.$airlyn.openPermissionPanel().then((function(e){console.log("got openPermission Panel then",e,JSON.stringify(e))})).catch((function(e){console.log("got openPermission Panel catch",e,JSON.stringify(e))})).finally((function(){"function"==typeof r&&(console.log("dopo il setting riport cmq a inizio"),r())})),!0},resetEvent:r||function(){},retryBtn:"Settings"});!t||"NotAllowedError"!==t.name&&"NotFoundError"!==t.name?this.showError(this.$t("errors.generic.title"),this.$t("errors.generic.description"),i,r):this.showError(this.$t("errors."+e+"."+t.name.toLowerCase()+".title"),this.$t("errors."+e+"."+t.name.toLowerCase()+".description"),i,r)},manageMicError:function(e,t,i){this.printDeviceError("mic",e,t,i)},manageCamError:function(e,t,i){this.printDeviceError("cam",e,t,i)},manageMicCamError:function(e,t,i){this.printDeviceError("miccam",e,t,i)},showError:function(e,t,i,r){this.$root.$emit("showError",{title:e,error:t,hasretry:null!==i,click:i||function(){},resetEvent:r||function(){}})},swipeEvent:function(e){this.$root.$emit("swipe",e)},attachSwipeListener:function(){document.addEventListener("swiped-left",this.swipeEvent),document.addEventListener("swiped-right",this.swipeEvent)},detachSwipeListeners:function(){document.removeEventListener("swiped-left",this.swipeEvent),document.removeEventListener("swiped-right",this.swipeEvent)},retrievePreferenceTutorial:function(){var e=this;this.$capacitor&&this.$capacitor.isNativePlatform()&&this.$airlyn.preferenceConfigure({group:"airlyn"}).finally((function(){console.log("preferences ready");var t="tutorial_"+e.name;e.$airlyn.preferenceGet({key:t}).then((function(i){console.log("preference read ("+t+")!",i),i&&i.value&&(1===i.value||"1"==i.value)&&(console.log("got preference Tutorial SEEN for",t,i.value),e.tutorialShownHard=!0)}))}))},setPreferenceTutorial:function(){if(this.$capacitor&&this.$capacitor.isNativePlatform()){var e="tutorial_"+this.name;this.$airlyn.preferenceSet({key:e,value:"1"}).finally((function(){console.log("preference stored for!",e)}))}this.setTutorialRun({page:this.name,index:this.currentTutorial.index}),this.tutorialShownHard=!0}}),beforeMount:function(){console.log("PRE loaded base Page"),this.setCurrentPage(this)},beforeDestroy:function(){this.detachSwipeListeners()},mounted:function(){var e=this;console.log("loaded base Page"),this.tutorialShownHard=!1,this.retrievePreferenceTutorial(),console.log("try Load index",this.name,this.dynamicTexts),this.dynamicTexts&&Object.keys(this.dynamicTexts).length>0&&Object.keys(this.dynamicTexts).map((function(t){e.$appConfiguration.getText(t).then((function(i){e.dynamicTexts[t]=i})).catch((function(i){e.dynamicTexts[t]=e.$t(e.name+"."+t)}))})),null!==this.getCurrentPagerHeight&&document.querySelector(".v-main__wrap > div.pager")&&(document.querySelector(".v-main__wrap > div.pager").style.height=this.getCurrentPagerHeight+"px"),this.$nextTick((function(){if(e.$capacitor&&e.$capacitor.isNativePlatform())console.log("Richiesto al passaggio precedente");else{var t=e.getLocalTutorialShown;t&&void 0!==t[e.name]?e.tutorialShownHard=!0:e.tutorialShownHard=!1}e.attachSwipeListener(),null===e.getCurrentPagerHeight&&document.querySelector(".v-main__wrap > div.pager")&&e.setCurrentPagerHeight(Math.max(document.querySelector(".v-main__wrap > div.pager").clientHeight,document.querySelector(".v-main__wrap > div.pager").offsetHeight))}))}}},924:function(e,t,i){"use strict";i.r(t);i(5),i(50);var r={props:{title:{type:String,default:"Info"},transition:{type:String,default:"dialog-bottom-transition"},contentclasses:{type:String,default:""},description:{type:String,default:"Info text"},infoImage:{type:String,default:null},showSuperTitle:{type:Boolean,default:!0},thumbInTitle:{type:Boolean,default:!0},show:{type:Boolean,default:!1}},data:function(){return{}},computed:{showDialog:function(){return this.show}},methods:{closeClick:function(e){this.$emit("close",e)}},mounted:function(){}},n=i(42),s=Object(n.a)(r,(function(){var e=this,t=e._self._c;return t("v-dialog",{attrs:{fullscreen:"","hide-overlay":"",transition:e.transition,scrollable:"","content-class":"infoDialog "+e.contentclasses},model:{value:e.showDialog,callback:function(t){e.showDialog=t},expression:"showDialog"}},[t("fullpage-card",{scopedSlots:e._u([{key:"header",fn:function(){return[t("div",{class:[(e.showSuperTitle?"with":"without")+"__supertitle",(e.thumbInTitle?"with":"without")+"__thumbInTitle"]},[e.showSuperTitle?t("div",{staticClass:"text-center supertitle"},[e._v("About")]):e._e(),e._v(" "),e.infoImage&&!0===e.thumbInTitle?t("img",{staticClass:"titleImage",attrs:{src:e.infoImage}}):e._e(),e._v(" "),t("div",{staticClass:"text-center infodialog__title",domProps:{innerHTML:e._s(e.title)}})])]},proxy:!0},{key:"body",fn:function(){return[t("div",{staticClass:"text-center content"},[e.infoImage&&!1===e.thumbInTitle?t("img",{staticClass:"errorimage",attrs:{src:e.infoImage}}):e._e(),e._v(" "),t("span",{class:[e.contentclasses,"withdynamicTexts"],domProps:{innerHTML:e._s(e.description)}})])]},proxy:!0},{key:"footer",fn:function(){return[t("div",{class:["pager"]},[t("v-btn",{attrs:{color:"nextvm",nuxt:""},on:{click:e.closeClick}},[e._t("closebtn",(function(){return[t("v-icon",[e._v("mdi-reload")]),e._v(" "),t("span",{domProps:{innerHTML:e._s(e.$t("generic.done"))}})]}))],2)],1)]},proxy:!0}],null,!0)})],1)}),[],!1,null,null,null);t.default=s.exports;installComponents(s,{FullpageCard:i(219).default})},926:function(e,t,i){"use strict";i.r(t);i(314);var r="abort",n="progress",s="start",o="visibilitychange",a={name:"CountDown",props:{interval:{type:Number,default:1e3},timerLength:{type:Number,default:1e4},reverse:{type:Boolean,default:!1},now:{type:Function,default:function(){return Date.now()}},emits:{EVENT_ABORT:r,EVENT_END:"end",EVENT_PROGRESS:n,EVENT_START:s}},data:function(){return{counting:!1,totalMilliseconds:0,requestId:0,endTime:0,elapsed:0}},computed:{totalSeconds:function(){return Math.floor(this.totalMilliseconds/1e3)}},watch:{$props:{deep:!0,immediate:!0,handler:function(){this.totalMilliseconds=this.timerLength,this.endTime=this.now()+this.timerLength}}},mounted:function(){document.addEventListener(o,this.handleVisibilityChange)},beforeUnmount:function(){document.removeEventListener(o,this.handleVisibilityChange),this.pause()},methods:{restart:function(){this.totalMilliseconds=this.timerLength,this.endTime=this.now()+this.timerLength,this.elapsed=0,this.start()},start:function(){this.counting||(this.counting=!0,this.$emit(s),"visible"===document.visibilityState&&this.continue())},getElapsed:function(){return this.elapsed},continue:function(){var e=this;if(this.counting){var t=Math.min(this.totalMilliseconds,this.interval);if(t>0){var i,r;this.requestId=requestAnimationFrame((function n(s){i||(i=s),r||(r=s);var o=s-i;o>=t||o+(s-r)/2>=t?e.progress():e.requestId=requestAnimationFrame(n),r=s}))}else this.end()}},pause:function(){cancelAnimationFrame(this.requestId)},progress:function(){this.counting&&(this.totalMilliseconds-=this.interval,this.elapsed+=this.interval,this.totalMilliseconds>0&&this.$emit(n,{totalSeconds:this.totalSeconds,totalMilliseconds:this.totalMilliseconds,interval:this.interval,elapsed:this.elapsed}),this.continue())},abort:function(){this.counting&&(this.pause(),this.counting=!1,this.$emit(r))},end:function(){this.counting&&(this.pause(),this.counting=!1,this.$emit("end",{totalSeconds:this.totalSeconds,totalMilliseconds:this.totalMilliseconds,interval:this.interval,elapsed:this.elapsed}),this.totalMilliseconds=0)},update:function(){this.counting&&(this.totalMilliseconds=Math.max(0,this.endTime-this.now()))},handleVisibilityChange:function(){switch(document.visibilityState){case"visible":this.update(),this.continue();break;case"hidden":this.pause()}}}},c=i(42),u=Object(c.a)(a,(function(){return(0,this._self._c)("div",{staticClass:"countdown_wrapper"})}),[],!1,null,null,null);t.default=u.exports},927:function(e,t,i){"use strict";i.r(t);i(314);var r={props:{value:{type:Number,default:0},exerciseSteps:{type:Number,default:1},startPercent:{type:Number,default:0},doneClass:{type:String,default:"done"},maxPercent:{type:Number,default:1},runningPercent:{type:Number,default:0}},computed:{primaryColor:function(){return $nuxt.$config.env.environment.indexOf("voicemed_")>-1?"#EC483F":"#848CE6"},exercisescount:function(){return this.exerciseSteps},currentExercise:function(){return this.value},currentPercent:function(){return this.runningPercent}},methods:{getRotation:function(e){return 0===e?"transform:rotate(0deg);":"transform:rotate("+360/this.exercisescount*e+"deg);"}}},n=i(42),s=Object(n.a)(r,(function(){var e=this,t=e._self._c;return t("div",{class:["donut_progress"]},[t("vc-donut",{attrs:{background:"#FFFFFF",foreground:"#848CE633",size:100,unit:"%",thickness:5,sections:[{label:"progress",value:e.currentPercent,color:e.primaryColor}],total:100,"start-angle":0,"auto-adjust-text-size":!0}},[e._t("inside")],2)],1)}),[],!1,null,null,null);t.default=s.exports},931:function(e,t,i){e.exports=i.p+"img/sine.8ad1fba.svg"},937:function(e,t,i){var r=i(951);r.__esModule&&(r=r.default),"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);(0,i(135).default)("07ca2686",r,!1,{sourceMap:!1})},950:function(e,t,i){"use strict";i(937)},951:function(e,t,i){var r=i(134),n=i(316),s=i(931),o=r((function(e){return e[1]})),a=n(s);o.push([e.i,".sine_merger{background-image:url("+a+")}",""]),o.locals={},e.exports=o},966:function(e,t,i){"use strict";i.r(t);i(5),i(50),i(8),i(9);var r=i(179),n=i(26),s=(i(0),i(7),i(6),i(37),i(3),i(112),i(28),i(62),i(923)),o=i(926),a=i(46);function c(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function u(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?c(Object(i),!0).forEach((function(t){Object(n.a)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):c(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var l=3e3,h={name:"ml_exercise",mixins:[s.a],components:{CountDownItem:o.default},beforeRouteLeave:function(e,t,i){this.$closeStream(),i()},data:function(){return{delay:!0,delayTime:0,preload:!0,exid:this.$route.params.id,programid:this.$route.params.fromprogram||!1,withindex:this.$route.params.withindex||!1,backto:this.$route.params.backto||!1,intervals:[],name:"ml_exercise",hasBack:!0,hasNext:!1,current:-1,realCurrent:-1,timer:0,startCountdown:3,finish:!1,uploadProgress:0,currentTime:0,currentRemaining:0,overallRemaining:0,currentProgress:0,currentExerciseTime:0,overallProgress:0,totalRunningTime:0,holdProgress:0,timeStart:0,timeEnd:0,timePauseStart:0,timePauseGap:0,estimatedDuration:0,recordingPhasesDuration:{},interval:250,holdMs:0,holdMsFragment:{},cycle:{current:-1,duration:0,elapsed:0},about:{show:!1}}},computed:u(u({},Object(a.d)({getExercises:"getExercises",getCurrentExercise:"getCurrentExercise",isCurrentUserGuest:"isCurrentUserGuest"})),{},{delayBreathTime:function(){return l},exercise:function(){return this.getCurrentExercise},exercises:function(){return this.exercise?this.exercise.exercises:[]},computedDuration:function(){return!(!this.getCurrentExercise||!Array.isArray(this.getCurrentExercise.exercises))&&this.getCurrentExercise.exercises.reduce((function(e,t){return 0+(t.duration||0)}),0)},exercisescount:function(){return this.exercise?this.exercise.exercises.length:0},exercisescountReal:function(){return this.exercise?this.exercise.exercises.filter((function(e){return!1===e.pause})).length:0},currentExercise:function(){return this.current>=0&&this.current<this.exercisescount?this.exercise.exercises[this.current]:this.exercisescount>0&&this.exercise.exercises[0]},timestring:function(){return new Date(this.totalRunningTime).toISOString().substr(14,5)},remainingString:function(){if(!0===this.currentExercise.hold)return" ";var e=1e3*this.estimatedDuration-this.totalRunningTime;return"-"+new Date(e).toISOString().substr(14,5)},overallRemainingString:function(){if(!0===this.currentExercise.hold)return" ";var e=this.totalTimeMs-(this.totalRunningTime+this.currentExerciseTime);return e<0?"-00:00":"-"+new Date(e).toISOString().substr(14,5)},currentPercent:function(){if(this.cycle.duration<=0)return 0;if(this.cycle.elapsed+this.currentExerciseTime<=0)return 0;var e=(this.cycle.elapsed+this.currentExerciseTime)/this.cycle.duration*100;return e>100?100:e},currentUploadProgress:function(){var e=100*this.uploadProgress;return e>100?100:e},totalTime:function(){return this.exercises.reduce((function(e,t){return e+t.duration}),0)+this.holdMs/1e3},totalTimeMs:function(){return this.exercises.reduce((function(e,t){return e+1e3*t.duration}),0)+this.holdMs}}),watch:{current:function(){var e=this;this.current>=0&&(this.cycle.current!==this.currentExercise.iteration&&(this.cycle.current=this.currentExercise.iteration,this.cycle.elapsed=0,this.cycle.duration=this.getCurrentExercise.exercises.reduce((function(t,i){return i.iteration===e.cycle.current?t+i.durationMs:t}),0)))}},methods:u(u({},Object(a.c)({addDoneExercise:"addDoneExercise",updateExercise:"updateExercise"})),{},{convertMsHHMMSS:function(e){var t=new Date(e).toISOString().substr(11,8);return 0===t.indexOf("00:")?t.substr(3):t},timerChange:function(e){var t=this;if(!0===this.delay)return this.delayTime-=e.interval,void(e.elapsed+e.interval>this.delayBreathTime&&this.$forceNextTick((function(){t.$refs.stepcountdown.end()})));if(this.currentExerciseTime+=e.interval,!1===this.currentExercise.hold?(this.currentProgress=100-e.totalSeconds/this.currentExercise.duration*100,this.currentRemaining=e.totalSeconds,this.currentTime=this.currentExercise.durationMs-e.totalMilliseconds):(this.currentProgress=100,this.holdMs+=e.interval),!1===this.currentExercise.pause){this.holdProgress+=e.interval;var i=(this.totalRunningTime+this.currentExerciseTime)/this.totalTimeMs*100;this.overallProgress=i>100?100:i}!1===this.currentExercise.hold&&e.elapsed+e.interval>this.currentExercise.durationMs&&this.$forceNextTick((function(){t.$refs.stepcountdown.end()}))},finishDelay:function(){var e=this;this.$refs.stepcountdown.end(),this.$anime({targets:".exercise_delay_info",opacity:[1,0],duration:500,delay:250,easing:"easeInOutQuad",complete:function(){e.delay=!1,e.$nextTick((function(){e.startRealExercise()}))}})},holdEnd:function(){this.$refs.stepcountdown.end()},timerEnd:function(e){var t=this;if(!0===this.delay)return this.delayTime-=e.interval,void this.$forceNextTick((function(){t.finishDelay()}));this.currentProgress=0,this.currentTime=0,this.totalRunningTime+=this.currentExercise.durationMs,this.cycle.elapsed+=this.currentExercise.durationMs,this.recordingPhasesDuration[this.current]=(new Date).getTime()-this.recordingPhasesDuration[this.current],!0===this.currentExercise.hold&&(this.holdMsFragment[this.current]=(new Date).getTime()-this.holdMsFragment[this.current]),console.log("END EXERCISE check seconds: ",(new Date).getTime()/1e3,this.recordingPhasesDuration[this.current]),this.$nextTick((function(){t.current++,t.currentExerciseTime=0,!1===t.currentExercise.pause&&t.realCurrent++,t.currentRemaining=t.currentExercise.duration,Object(r.a)(document.querySelectorAll(".faded")).forEach((function(e){e.classList.remove("faded")})),t.current<t.exercisescount?requestAnimationFrame((function(){t.manageExercise()})):(t.uploadProgress=0,t.finish=!0,t.finishExercise())}))},leaveMe:function(){this.$gtag("event","click",{event_label:"StopRecording",event_category:"Exercises",non_interaction:!0}),this.$analytics.logEvent("exercise_quit",{id:this.getCurrentExercise.id,name:this.getCurrentExercise.title,program_id:this.getCurrentExercise.program_id||null,type:this.getCurrentExercise.type}),this.intervals.map((function(e){try{clearTimeout(e)}catch(e){}})),this.$refs.stepcountdown.abort(),document.querySelector("#__nuxt")&&document.querySelector("#__nuxt").classList.add("quit"),this.exerciseStepBack()},getRotation:function(e){return 0===e?"transform:rotate(0deg);":"transform:rotate("+360/this.exercisescount*e+"deg);"},imageError:function(){this.phasebutton.phaseimage=i(315)},prevStep:function(){this.about.show?this.closeInfo():(this.intervals.map((function(e){try{clearTimeout(e)}catch(e){}})),this.$refs.stepcountdown.abort(),this.$router.back(),this.$gtag("event","click",{event_label:"StopRecording",event_category:"Exercises",non_interaction:!0}))},nextStep:function(){this.$root.$emit("showPager",{show:!1});var e=this.buildSuffix();e.length>0&&(e="/"+e),this.$router.push($nuxt.localePath("/ml/greetings/"+this.exid+e))},finishExercise:function(){var e=this;this.timeEnd=(new Date).getTime(),this.$anime.remove(".breath_item"),document.querySelector("div.breath_item")&&document.querySelector("div.breath_item").classList.remove("animating"),this.$nextTick((function(){var t=Object.assign({targets:".breath_item",loop:!1,easing:"easeInOutQuad",duration:3e3,begin:function(){document.querySelector("div.breath_item")&&document.querySelector("div.breath_item").classList.add("animating")},complete:function(){document.querySelector("div.breath_item")&&document.querySelector("div.breath_item").classList.remove("animating")}},e.$animationHelper.pulse);e.$anime(t)})),Object.keys(this.recordingPhasesDuration).map((function(t){e.recordingPhasesDuration[t]=e.recordingPhasesDuration[t]>0?e.recordingPhasesDuration[t]/1e3:0}));var t=0;Object.keys(this.recordingPhasesDuration).map((function(t){e.recordingPhasesDuration[t]=e.recordingPhasesDuration[t]>0?e.recordingPhasesDuration[t]/1e3:0})),Object.keys(this.holdMsFragment).map((function(i){t+=1,e.holdMsFragment[i]>0?e.holdMsFragment[i]/1e3:0}));var i={exerciseStarts:this.timeStart/1e3,exerciseEnds:this.timeEnd/1e3,pauseTime:this.timePauseGap>0?this.timePauseGap/1e3:0,totalComputedDuration:(this.timeEnd-this.timeStart)/1e3,estimatedDuration:this.estimatedDuration,clientPhases:this.recordingPhasesDuration,totalHeldTime:this.holdMs>0?this.holdMs/1e3:0,averageHeldTime:this.holdMs>0?this.holdMs/t/1e3:0},r=setInterval((function(){e.uploadProgress+=.2}),250);this.intervals.push(setTimeout((function(){clearInterval(r),e.sendRecord(null,i)}),1e3))},sendRecord:function(e,t){var i=this;this.uploadProgress=0,this.loading=!0;var r=new Date,n=(this.$auth.user?this.$auth.user._id||this.$auth.user.userId:r.getMilliseconds(),!1);this.$exerciseManager.completeExercise(this.getCurrentExercise,(function(e){i.uploadProgress=e.loaded/e.total-.05}),null,t).then((function(e){i.uploadProgress=1,n=!!(e.exercise&&e.response&&e.exercise.completed)||$nuxt.$t("errors.global.msg_restapi"),console.log("got record result",e)})).catch((function(e){console.error("Errore invio api [breathing_exercises]:",e),i.$captureException(e),n=$nuxt.$t("errors.global.title"),i.$analytics.logEvent("error",{title:"cannot send exercise"})})).finally((function(){!0===n?(i.isCurrentUserGuest&&i.addDoneExercise(1),i.nextStep()):i.$root.$emit("showError",{hasretry:!0,title:$nuxt.$t("errors.global.uhoh"),error:n,click:function(){return i.startExercises(),!0},resetEvent:function(){return this.exerciseStepBack(),!0}})}))},closeInfo:function(){this.about.show=!1,this.$refs.stepcountdown.start();var e=(new Date).getTime()-this.timePauseStart;this.timePauseGap+=e,console.log("countdown resumed total Pause: ",this.timePauseGap)},openInfoDialog:function(){},manageExercise:function(){var e=this;if(this.$anime.remove(".breath_item"),document.querySelector("div.breath_item")&&document.querySelector("div.breath_item").classList.remove("animating"),Object(r.a)(document.querySelectorAll(".faded")).forEach((function(e){e.classList.remove("faded")})),this.recordingPhasesDuration[this.current]=(new Date).getTime(),this.currentExercise.hold&&(this.holdProgress=0,this.holdMsFragment[this.current]=(new Date).getTime()),this.current>=0){this.estimatedDuration+=this.currentExercise.hold?0:this.currentExercise.duration,this.$refs.stepcountdown.restart();var t=Object.assign({targets:".breath_item",loop:this.currentExercise.hold,easing:"easeOutSine",duration:this.currentExercise.hold?3e3:this.currentExercise.durationMs-50,begin:function(){document.querySelector("div.breath_item")&&document.querySelector("div.breath_item").classList.add("animating")},complete:function(){document.querySelector("div.breath_item")&&document.querySelector("div.breath_item").classList.remove("animating")}},this.currentExercise.animation);!1===this.currentExercise.pause&&requestAnimationFrame((function(){e.$anime(t)}))}},startTimer:function(){var e=this;this.intervals.push(setTimeout((function(){e.timer++,!1===e.finish&&e.startTimer()}),1e3))},startExercises:function(){var e=this;this.$analytics.logEvent("exercise_begin_recording",{id:this.getCurrentExercise.id,name:this.getCurrentExercise.title,program_id:this.getCurrentExercise.program_id||null,type:this.getCurrentExercise.type}),this.$exerciseManager.startExercise(this.getCurrentExercise),this.$analytics.setScreenName(this.getCurrentExercise.title+" "+this.getCurrentExercise.type+" page"),this.$gtag("event","click",{event_label:"BeginRecording",event_category:"Exercises",non_interaction:!0}),this.delay=!0,this.delayTime=l,this.current=0,this.realCurrent=0,this.overallProgress=0,this.holdMs=0,this.currentExerciseTime=0,this.overallRemaining=this.totalTimeMs,this.finish=!1,this.cycle.current=0,this.cycle.duration=0,this.cycle.elapsed=0,this.$set(this,"recordingPhasesDuration",{}),this.totalRunningTime=0,this.current=0,this.realCurrent=0,Object(r.a)(document.querySelectorAll(".faded")).forEach((function(e){e.classList.remove("faded")})),this.$forceNextTick((function(){e.$refs.stepcountdown.restart()}))},startRealExercise:function(){this.setupAll()},setupAll:function(){this.$nuxt.$loading.finish(),this.timeStart=0,this.timeEnd=0,this.estimatedDuration=0,this.timePauseStart=0,this.timePauseGap=0,this.holdMs=0,this.currentTime=0,this.timeStart=(new Date).getTime(),Object(r.a)(document.querySelectorAll(".faded")).forEach((function(e){e.classList.remove("faded")})),console.log("ready to Record",(new Date).getTime()/1e3,this.estimatedDuration),this.manageExercise()}}),mounted:function(){var e=this;this.delayTime=l,this.delay=!0,this.exercise||this.$router.replace($nuxt.localePath("/ml/exercises/"+this.exid)),this.interval=250,this.timer=0,this.$root.$emit("showPager",{show:!1});var t=Object(r.a)(document.querySelectorAll(".fakeTitles")).reduce((function(e,t){return Math.max(e,Math.max(t.offsetHeight,t.clientHeight,t.scrollHeight))}),0);document.querySelector("#exerciseTitle")&&(document.querySelector("#exerciseTitle").style.height=t+"px"),this.preload=!1,this.$nextTick((function(){e.$root.$emit("setNextText",e.$t("generic.next")),e.startExercises()}))}},d=(i(950),i(42)),m=Object(d.a)(h,(function(){var e=this,t=e._self._c;return t("fullpage-card",{staticClass:"runner exercisecc exerciseRecording",attrs:{hidefooter:!0},scopedSlots:e._u([{key:"header",fn:function(){return[t("v-row",{staticClass:"navigation",attrs:{"align-content":"center",justify:"space-between"}},[t("v-btn",{attrs:{icon:""},on:{click:e.leaveMe}},[t("v-icon",[e._v("mdi-close-circle-outline")])],1),e._v(" "),e.getCurrentExercise?t("div",{staticClass:"exercise__title"},[t("span",{domProps:{innerHTML:e._s(e.getCurrentExercise.title)}})]):e._e(),e._v(" "),t("v-btn",{staticStyle:{opacity:"0"},attrs:{icon:""},on:{click:e.openInfoDialog}},[t("v-icon",[e._v("mdi-information-outline")])],1)],1),e._v(" "),e.finish||!1!==e.delay?e._e():t("div",{staticClass:"exerciseSpecs animated faded"},[e.currentExercise.thumb?t("v-img",{attrs:{src:e.currentExercise.thumb,width:"20vw",contain:""}}):e._e()],1),e._v(" "),e.preload?t("div",{staticClass:"text-center mintwoRows"},e._l(e.exercises,(function(i){return t("div",{staticClass:"fakeTitles text-center"},[t("span",[e._v(e._s(i.title))]),e._v(" "),t("p",{staticClass:"exerciseSecText"},[e._v(e._s(i.description))])])})),0):e._e()]},proxy:!0},{key:"body",fn:function(){return[!1===e.currentExercise.pause?t("div",{class:["exercises__container animated faded",e.getCurrentExercise.type]},[e.delay?t("div",{key:e.delayTime,staticClass:"exercise_delay_info"},[t("div",{staticClass:"timer text-center"},[t("p",{domProps:{innerHTML:e._s(e.$t("generic.exercisestart"))}}),e._v(" "),t("p",{staticClass:"timer__numbers"},[e._v(e._s(Math.ceil(e.delayTime/1e3)))])])]):e._e(),e._v(" "),(e.finish||e.currentExercise)&&!1===e.delay?t("exerciseanimationprogress",{key:e.delay,class:e.currentExercise.animationType+" "+(e.finish?"finished":"")+" "+(e.currentExercise.hold?"holdme":""),attrs:{exerciseSteps:e.finish?0:e.getCurrentExercise.cycles,startPercent:0,maxPercent:0,doneClass:"doneNone",runningPercent:e.finish?e.currentUploadProgress:e.currentPercent},scopedSlots:e._u([{key:"inside",fn:function(){return[e.finish?e._e():t("div",{staticClass:"breath_item"}),e._v(" "),e.currentExercise?t("div",{staticClass:"action"},[t("transition",{attrs:{mode:"out-in",name:"exittop"}},[e.finish?t("div",{domProps:{innerHTML:e._s(e.$t("ml_exercise.almostdone"))}}):t("div",{key:e.current},[e._v("\n                "+e._s(e.currentExercise.title||"")+"\n              ")])])],1):e._e()]},proxy:!0}],null,!1,289655709),model:{value:e.current,callback:function(t){e.current=t},expression:"current"}}):e._e(),e._v(" "),!1===e.delay?t("div",{class:["timer text-center animated",e.finish?"faded":""]},[t("v-progress-linear",{style:!0===e.currentExercise.hold?"opacity:0;":"",model:{value:e.overallProgress,callback:function(t){e.overallProgress=t},expression:"overallProgress"}}),e._v(" "),t("transition",{attrs:{mode:"out-in",name:"exittop"}},[!0!==e.currentExercise.hold?t("small",{key:e.currentExercise.hold},[e.getCurrentExercise.cycles>1?[e._v(e._s(e.currentExercise.iteration)+" of "+e._s(e.getCurrentExercise.cycles)+" | \n            ")]:e._e(),e._v("\n            "+e._s(e.overallRemainingString)+"\n          ")],2):t("small",{key:e.currentExercise.hold},[e._v("\n            "+e._s(e.convertMsHHMMSS(e.holdProgress))+"\n          ")])])],1):e._e()],1):t("div",{class:["exercises__waiting animated",e.currentRemaining%2==1?"odd":"even"]},[t("small",{domProps:{innerHTML:e._s(e.$t("generic.startagain"))}}),e._v("\n      "+e._s(e.currentRemaining)+"\n    ")]),e._v(" "),t("transition",{attrs:{name:"fade"}},[!0===e.currentExercise.hold&&!1===e.currentExercise.pause?t("div",{staticClass:"holdcontainer"},[t("p",[e._v(e._s(e.$t("ml_exercise.stop_hold_phase_desc")))]),e._v(" "),t("v-btn",{staticClass:"nextvm",on:{click:e.holdEnd}},[t("v-icon",[e._v("mdi-square")]),e._v(" "+e._s(e.$t("ml_exercise.stop_hold_phase_cta"))+"\n        ")],1)],1):e._e()]),e._v(" "),t("a",{staticStyle:{display:"none"},attrs:{href:"#",id:"downloader"}},[e._v("Download audio")]),e._v(" "),t("CountDownItem",{ref:"stepcountdown",attrs:{timerLength:!0===e.delay?e.delayBreathTime:e.currentExercise.hold?864e5:e.currentExercise.durationMs,interval:e.interval},on:{progress:e.timerChange,end:e.timerEnd}}),e._v(" "),e.getCurrentExercise?t("infodialog",{attrs:{show:e.about.show,contentclasses:"infoContent",title:e.getCurrentExercise.title,description:e.getCurrentExercise.about||"",infoImage:e.getCurrentExercise.aboutImage||e.getCurrentExercise.thumbnail},on:{close:e.closeInfo},scopedSlots:e._u([{key:"closebtn",fn:function(){return[e._v(e._s(e.$t("generic.alright")))]},proxy:!0}],null,!1,3628382813)}):e._e()]},proxy:!0}])})}),[],!1,null,null,null);t.default=m.exports;installComponents(m,{Exerciseanimationprogress:i(927).default,Infodialog:i(924).default,FullpageCard:i(219).default})}}]);
//# sourceMappingURL=14a4129.js.map